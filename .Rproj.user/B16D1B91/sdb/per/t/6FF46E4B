{
    "collab_server" : "",
    "contents" : "---\ntitle: \"Regression by IGF1R positivity\"\neditor_options: \n  chunk_output_type: console\n---\n\n```{r global, message=FALSE, warning=FALSE, echo=FALSE}\nsource(\"global.R\")\n\n# Libraries\nlibrary(survival)\n```\n\n***\n\n# Tumor progression\n## Unadjusted model\n```{r unadjusted_progression}\n# Age\nmdl_unadj <- coxph(\n  Surv(fu_progression, as.numeric(progression)) ~ age,\n  data = DF\n)\nsum_mdl_unadj <- summary(mdl_unadj)\nmdl_tbl_unadj <- t(c(\n    sum_mdl_unadj$conf.int[ , -2],\n    sum_mdl_unadj$coefficients[ , 5]\n    )) %>% \n    formatC(digits = 2, format = \"fg\") %>% \n    data.frame()\nrownames(mdl_tbl_unadj) <- c(\"Age, per 1 year increase\")\nunadj_age <- mdl_tbl_unadj\n\n# Sex\nmdl_unadj <- coxph(\n  Surv(fu_progression, as.numeric(progression)) ~ sex,\n  data = DF\n)\nsum_mdl_unadj <- summary(mdl_unadj)\nmdl_tbl_unadj <- t(c(\n    sum_mdl_unadj$conf.int[ , -2],\n    sum_mdl_unadj$coefficients[ , 5]\n    )) %>% \n    formatC(digits = 2, format = \"fg\") %>% \n    data.frame()\nrownames(mdl_tbl_unadj) <- c(\"Sex: Female vs Male\")\nunadj_sex <- mdl_tbl_unadj\n\n# Location\nmdl_unadj <- coxph(\n  Surv(fu_progression, as.numeric(progression)) ~ location,\n  data = DF\n)\nsum_mdl_unadj <- summary(mdl_unadj)\nmdl_tbl_unadj <- cbind(\n    sum_mdl_unadj$conf.int[ , -2],\n    sum_mdl_unadj$coefficients[ , 5]\n    ) %>% \n    formatC(digits = 2, format = \"fg\") %>% \n    data.frame()\nrownames(mdl_tbl_unadj) <- c(\n    \"Location: Ureter vs Pelvis\",\n    \"Location: Pelvis-ureter vs Pelvis\"\n)\nunadj_location <- mdl_tbl_unadj\n\n# pT stage\nmdl_unadj <- coxph(\n  Surv(fu_progression, as.numeric(progression)) ~ high_pt,\n  data = DF\n)\nsum_mdl_unadj <- summary(mdl_unadj)\nmdl_tbl_unadj <- t(c(\n    sum_mdl_unadj$conf.int[ , -2],\n    sum_mdl_unadj$coefficients[ , 5]\n    )) %>% \n    formatC(digits = 2, format = \"fg\") %>% \n    data.frame()\nrownames(mdl_tbl_unadj) <- c(\n    \"pT stage: High stage vs Low stage\"\n)\nunadj_pt <- mdl_tbl_unadj\n\n# Grade\nmdl_unadj <- coxph(\n  Surv(fu_progression, as.numeric(progression)) ~ grade,\n  data = DF\n)\nsum_mdl_unadj <- summary(mdl_unadj)\nmdl_tbl_unadj <- cbind(\n    sum_mdl_unadj$conf.int[ , -2],\n    sum_mdl_unadj$coefficients[ , 5]\n    ) %>% \n    formatC(digits = 2, format = \"fg\") %>% \n    data.frame()\nrownames(mdl_tbl_unadj) <- c(\n    \"Grade: Grade 2 vs Grade 1\",\n    \"Grade: Grade 3 vs Grade 1\"\n)\nunadj_grade <- mdl_tbl_unadj\n\n# Lymphovascular invasion\nmdl_unadj <- coxph(\n  Surv(fu_progression, as.numeric(progression)) ~ lvi,\n  data = DF\n)\nsum_mdl_unadj <- summary(mdl_unadj)\nmdl_tbl_unadj <- t(c(\n    sum_mdl_unadj$conf.int[ , -2],\n    sum_mdl_unadj$coefficients[ , 5]\n    )) %>% \n    formatC(digits = 2, format = \"fg\") %>% \n    data.frame()\nrownames(mdl_tbl_unadj) <- c(\n    \"Lymphovascular invasion: Present vs Absent\"\n)\nunadj_lvi <- mdl_tbl_unadj\n\n# Lymph nodes metastasis\nmdl_unadj <- coxph(\n  Surv(fu_progression, as.numeric(progression)) ~ lymph_nodes,\n  data = DF\n)\nsum_mdl_unadj <- summary(mdl_unadj)\nmdl_tbl_unadj <- t(c(\n    sum_mdl_unadj$conf.int[ , -2],\n    sum_mdl_unadj$coefficients[ , 5]\n    )) %>% \n    formatC(digits = 2, format = \"fg\") %>% \n    data.frame()\nrownames(mdl_tbl_unadj) <- c(\n    \"Lymph nodes metastasis: Present vs Absent\"\n)\nunadj_lymph_nodes <- mdl_tbl_unadj\n\n# IFG1R\nmdl_unadj <- coxph(\n  Surv(fu_progression, as.numeric(progression)) ~ igf1r_exprs,\n  data = DF\n)\nsum_mdl_unadj <- summary(mdl_unadj)\nmdl_tbl_unadj <- t(c(\n    sum_mdl_unadj$conf.int[ , -2],\n    sum_mdl_unadj$coefficients[ , 5]\n    )) %>% \n    formatC(digits = 2, format = \"fg\") %>% \n    data.frame()\nrownames(mdl_tbl_unadj) <- c(\n    \"IGF1R: Positive vs Negative\"\n)\nunadj_ifg1r_exprs <- mdl_tbl_unadj\n\n# Merging tables\nmdl_tbl_unadj <- rbind(\n    unadj_age,\n    unadj_sex,\n    unadj_location,\n    unadj_pt,\n    unadj_grade,\n    unadj_lvi,\n    unadj_lymph_nodes,\n    unadj_ifg1r_exprs\n)\n\n# Final table\nkable(\n    mdl_tbl_unadj,\n    col.names = c(\"HR\", \"Lower .95\", \"Upper .95\", \"P value\"),\n    align = c(\"c\")\n)\n```\n\n\n## Adjusted model\n```{r adjusted_progression}\nmdl <- coxph(\n  Surv(fu_progression, as.numeric(progression)) ~ age + sex + location + high_pt + grade + lvi + lymph_nodes + igf1r_exprs,\n  data = DF\n)\n\nsum_mdl <- summary(mdl)\n\nmdl_tbl <- cbind(\n    sum_mdl$conf.int[ , -2],\n    sum_mdl$coefficients[ , 5]\n)\n\nrownames(mdl_tbl) <- c(\n    \"Age, per 1 year increase\",\n    \"Sex: Female vs Male\",\n    \"Location: Ureter vs Pelvis\",\n    \"Location: Pelvis-ureter vs Pelvis\",\n    \"pT stage: High stage vs Low stage\",\n    \"Grade: Grade 2 vs Grade 1\",\n    \"Grade: Grade 3 vs Grade 1\",\n    \"Lymphovascular invasion: Present vs Absent\",\n    \"Lymph nodes metastasis: Present vs Absent\",\n    \"IGF1R: Positive vs Negative\"\n)\n\nkable(\n    formatC(mdl_tbl, digits = 2, format = \"fg\"),\n    col.names = c(\"HR\", \"Lower .95\", \"Upper .95\", \"P value\"),\n    align = c(\"c\")\n)\n```\n\n***\n\n# Cancer-specific mortality\n## Unadjusted model\n```{r unadjusted_dod}\n# Age\nmdl_unadj <- coxph(\n  Surv(fu_progression, as.numeric(dod)) ~ age,\n  data = DF\n)\nsum_mdl_unadj <- summary(mdl_unadj)\nmdl_tbl_unadj <- t(c(\n    sum_mdl_unadj$conf.int[ , -2],\n    sum_mdl_unadj$coefficients[ , 5]\n    )) %>% \n    formatC(digits = 2, format = \"fg\") %>% \n    data.frame()\nrownames(mdl_tbl_unadj) <- c(\"Age, per 1 year increase\")\nunadj_age <- mdl_tbl_unadj\n\n# Sex\nmdl_unadj <- coxph(\n  Surv(fu_progression, as.numeric(dod)) ~ sex,\n  data = DF\n)\nsum_mdl_unadj <- summary(mdl_unadj)\nmdl_tbl_unadj <- t(c(\n    sum_mdl_unadj$conf.int[ , -2],\n    sum_mdl_unadj$coefficients[ , 5]\n    )) %>% \n    formatC(digits = 2, format = \"fg\") %>% \n    data.frame()\nrownames(mdl_tbl_unadj) <- c(\"Sex: Female vs Male\")\nunadj_sex <- mdl_tbl_unadj\n\n# Location\nmdl_unadj <- coxph(\n  Surv(fu_progression, as.numeric(dod)) ~ location,\n  data = DF\n)\nsum_mdl_unadj <- summary(mdl_unadj)\nmdl_tbl_unadj <- cbind(\n    sum_mdl_unadj$conf.int[ , -2],\n    sum_mdl_unadj$coefficients[ , 5]\n    ) %>% \n    formatC(digits = 2, format = \"fg\") %>% \n    data.frame()\nrownames(mdl_tbl_unadj) <- c(\n    \"Location: Ureter vs Pelvis\",\n    \"Location: Pelvis-ureter vs Pelvis\"\n)\nunadj_location <- mdl_tbl_unadj\n\n# pT stage\nmdl_unadj <- coxph(\n  Surv(fu_progression, as.numeric(dod)) ~ high_pt,\n  data = DF\n)\nsum_mdl_unadj <- summary(mdl_unadj)\nmdl_tbl_unadj <- t(c(\n    sum_mdl_unadj$conf.int[ , -2],\n    sum_mdl_unadj$coefficients[ , 5]\n    )) %>% \n    formatC(digits = 2, format = \"fg\") %>% \n    data.frame()\nrownames(mdl_tbl_unadj) <- c(\n    \"pT stage: High stage vs Low stage\"\n)\nunadj_pt <- mdl_tbl_unadj\n\n# Grade\nmdl_unadj <- coxph(\n  Surv(fu_progression, as.numeric(dod)) ~ grade,\n  data = DF\n)\nsum_mdl_unadj <- summary(mdl_unadj)\nmdl_tbl_unadj <- cbind(\n    sum_mdl_unadj$conf.int[ , -2],\n    sum_mdl_unadj$coefficients[ , 5]\n    ) %>% \n    formatC(digits = 2, format = \"fg\") %>% \n    data.frame()\nrownames(mdl_tbl_unadj) <- c(\n    \"Grade: Grade 2 vs Grade 1\",\n    \"Grade: Grade 3 vs Grade 1\"\n)\nunadj_grade <- mdl_tbl_unadj\n\n# Lymphovascular invasion\nmdl_unadj <- coxph(\n  Surv(fu_progression, as.numeric(dod)) ~ lvi,\n  data = DF\n)\nsum_mdl_unadj <- summary(mdl_unadj)\nmdl_tbl_unadj <- t(c(\n    sum_mdl_unadj$conf.int[ , -2],\n    sum_mdl_unadj$coefficients[ , 5]\n    )) %>% \n    formatC(digits = 2, format = \"fg\") %>% \n    data.frame()\nrownames(mdl_tbl_unadj) <- c(\n    \"Lymphovascular invasion: Present vs Absent\"\n)\nunadj_lvi <- mdl_tbl_unadj\n\n# Lymph nodes metastasis\nmdl_unadj <- coxph(\n  Surv(fu_progression, as.numeric(dod)) ~ lymph_nodes,\n  data = DF\n)\nsum_mdl_unadj <- summary(mdl_unadj)\nmdl_tbl_unadj <- t(c(\n    sum_mdl_unadj$conf.int[ , -2],\n    sum_mdl_unadj$coefficients[ , 5]\n    )) %>% \n    formatC(digits = 2, format = \"fg\") %>% \n    data.frame()\nrownames(mdl_tbl_unadj) <- c(\n    \"Lymph nodes metastasis: Present vs Absent\"\n)\nunadj_lymph_nodes <- mdl_tbl_unadj\n\n# IFG1R\nmdl_unadj <- coxph(\n  Surv(fu_progression, as.numeric(dod)) ~ igf1r_exprs,\n  data = DF\n)\nsum_mdl_unadj <- summary(mdl_unadj)\nmdl_tbl_unadj <- t(c(\n    sum_mdl_unadj$conf.int[ , -2],\n    sum_mdl_unadj$coefficients[ , 5]\n    )) %>% \n    formatC(digits = 2, format = \"fg\") %>% \n    data.frame()\nrownames(mdl_tbl_unadj) <- c(\n    \"IGF1R: Positive vs Negative\"\n)\nunadj_ifg1r_exprs <- mdl_tbl_unadj\n\n# Merging tables\nmdl_tbl_unadj <- rbind(\n    unadj_age,\n    unadj_sex,\n    unadj_location,\n    unadj_pt,\n    unadj_grade,\n    unadj_lvi,\n    unadj_lymph_nodes,\n    unadj_ifg1r_exprs\n)\n\n# Final table\nkable(\n    mdl_tbl_unadj,\n    col.names = c(\"HR\", \"Lower .95\", \"Upper .95\", \"P value\"),\n    align = c(\"c\")\n)\n```\n\n\n## Adjusted model\n```{r adjusted_dod}\nmdl <- coxph(\n  Surv(fu_progression, as.numeric(dod)) ~ age + sex + location + high_pt + grade + lvi + lymph_nodes + igf1r_exprs,\n  data = DF\n)\n\nsum_mdl <- summary(mdl)\n\nmdl_tbl <- cbind(\n    sum_mdl$conf.int[ , -2],\n    sum_mdl$coefficients[ , 5]\n)\n\nrownames(mdl_tbl) <- c(\n    \"Age, per 1 year increase\",\n    \"Sex: Female vs Male\",\n    \"Location: Ureter vs Pelvis\",\n    \"Location: Pelvis-ureter vs Pelvis\",\n    \"pT stage: High stage vs Low stage\",\n    \"Grade: Grade 2 vs Grade 1\",\n    \"Grade: Grade 3 vs Grade 1\",\n    \"Lymphovascular invasion: Present vs Absent\",\n    \"Lymph nodes metastasis: Present vs Absent\",\n    \"IGF1R: Positive vs Negative\"\n)\n\nkable(\n    formatC(mdl_tbl, digits = 2, format = \"fg\"),\n    col.names = c(\"HR\", \"Lower .95\", \"Upper .95\", \"P value\"),\n    align = c(\"c\")\n)\n```\n\n",
    "created" : 1527112677999.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "93238032",
    "id" : "6FF46E4B",
    "lastKnownWriteTime" : 1527203065,
    "last_content_update" : 1527203065175,
    "path" : "C:/Users/Alcides Chaux/Google Drive/research/Projects_Analysis/IFG1R-UTUC/report/outcome-regression-igf1rexprs.Rmd",
    "project_path" : "outcome-regression-igf1rexprs.Rmd",
    "properties" : {
        "chunk_output_type" : "console",
        "docOutlineVisible" : "1"
    },
    "relative_order" : 1,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_markdown"
}